@using FamilieLaissFrontend.Client.ViewModels.Controls.Filter
@using FamilieLaissInterfaces.Models
@using FamilieLaissInterfaces.Services
@using FamilieLaissResources.Resources.Controls.Filter
@using FamilieLaissSharedUI.Components

@inherits FlComponentBase<FilterNumberListControlViewModel>

<MudStack Style="width: 100%">
    <MudStack Row="true" Spacing="1">
        <MudText Typo="Typo.body1">@FilterCriteria.DisplayText</MudText>
        @if (ViewModel.SelectedValue is not null)
        {
            <MudTooltip Arrow="true"
                        Placement="Placement.Top"
                        ShowOnFocus="false"
                        Text="@FilterNumberListControlRes.DeleteFilter">
                <MudIconButton Color="Color.Error"
                               Size="Size.Small"
                               Icon="@Icons.Material.Filled.Clear"
                               OnClick="async () => await ViewModel.ResetFilterCommand.ExecuteAsync(null)">
                </MudIconButton>
            </MudTooltip>
        }
    </MudStack>

    <MudSelectExtended SearchBox="true"
                       T="FilterItemNumberValue"
                       ItemCollection="ViewModel.FilterItems"
                       SearchBoxAutoFocus="true"
                       ToStringFunc="@(v => v?.DisplayText)"
                       FullWidth="true"
                       Dense="true"
                       @bind-Value="ViewModel.SelectedValue"
                       HelperText="@FilterNumberListControlRes.DropDownHelperText"
                       SearchBoxClearable="true"></MudSelectExtended>
</MudStack>

@code
{
    [Parameter]
    [EditorRequired]
    public IGraphQlFilterCriteria FilterCriteria 
    { 
        get
        {
            return ViewModel.FilterCriteria;
        }
        set
        {
            ViewModel.FilterCriteria = value;
        }
    } 

    [Parameter]
    [EditorRequired]
    public EventCallback<(Guid id, bool hasValue)> ValueChanged 
    { 
        get
        {
            return ViewModel.ValueChanged;
        }
        set
        {
            ViewModel.ValueChanged = value;
        }
    }
}