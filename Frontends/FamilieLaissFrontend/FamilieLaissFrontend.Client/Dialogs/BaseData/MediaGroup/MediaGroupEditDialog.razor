@using FamilieLaissEnums
@using FamilieLaissFrontend.Client.ViewModels.Dialogs.BaseData.MediaGroup
@using FamilieLaissInterfaces.Models.Data
@using FamilieLaissResources.Resources.Dialogs.BaseData.MediaGroup
@using FamilieLaissSharedUI.Components

@inherits FlComponentBase<MediaGroupEditDialogViewModel>

<MudDialog>
    <DialogContent>
        <MudContainer Style="max-height: 460px; overflow-y: scroll">
            <MudForm Model="@Model" @ref="ViewModel.Form" Validation="@(ViewModel.Validator.ValidateValue)">
                @if (Model is not null)
                {
                    <MudDatePicker @ref="ViewModel.PickerEventDate"
                                   Label="@MediaGroupEditDialogRes.LabelEventDate"
                                   @bind-Date="Model.EventDateForInput"
                                   ShowWeekNumbers="true"
                                   AutoClose="true"
                                   Placeholder="@MediaGroupEditDialogRes.DescriptionEventDate">
                        <PickerActions>
                            <MudButton Class="mr-auto align-self-start" OnClick="async () => await ViewModel.GoToTodayCommand.ExecuteAsync(null)">Today</MudButton>
                        </PickerActions>
                    </MudDatePicker>
                    <MudTextField Disabled="@ViewModel.IsBusy"
                                  @bind-Value="Model.NameGerman"
                                  For="@(() => Model.NameGerman)"
                                  Label="@MediaGroupEditDialogRes.LabelNameGerman"
                                  HelperText="@MediaGroupEditDialogRes.DescriptionNameGerman"
                                  HelperTextOnFocus="true"
                                  Variant="MudBlazor.Variant.Text" />
                    <MudTextField Disabled="@ViewModel.IsBusy"
                                  @bind-Value="Model.NameEnglish"
                                  For="@(() => Model.NameEnglish)"
                                  Label="@MediaGroupEditDialogRes.LabelNameEnglish"
                                  HelperText="@MediaGroupEditDialogRes.DescriptionNameEnglish"
                                  HelperTextOnFocus="true"
                                  Variant="MudBlazor.Variant.Text" />
                    <MudTextField Disabled="@ViewModel.IsBusy"
                                  @bind-Value="Model.DescriptionGerman"
                                  For="@(() => Model.DescriptionGerman)"
                                  Lines="4"
                                  Label="@MediaGroupEditDialogRes.LabelDescriptionGerman"
                                  HelperText="@MediaGroupEditDialogRes.DescriptionDescriptionGerman"
                                  HelperTextOnFocus="true"
                                  Variant="MudBlazor.Variant.Text" />
                    <MudTextField Disabled="@ViewModel.IsBusy"
                                  @bind-Value="Model.DescriptionEnglish"
                                  For="@(() => Model.DescriptionEnglish)"
                                  Lines="4"
                                  Label="@MediaGroupEditDialogRes.LabelDescriptionEnglish"
                                  HelperText="@MediaGroupEditDialogRes.DescriptionDescriptionEnglish"
                                  HelperTextOnFocus="true"
                                  Variant="MudBlazor.Variant.Text" />
                }
            </MudForm>
        </MudContainer>
    </DialogContent>
    <DialogActions>
        @if (ViewModel.SaveMode == EnumSaveMode.Save)
        {
            <MudTooltip Placement="Placement.Top" Arrow="true" Text="@MediaGroupEditDialogRes.TooltipSave" ShowOnFocus="false">
                <MudLoadingButton Loading="@ViewModel.IsSaving"
                                  LoadingAdornment="Adornment.Start"
                                  StartIcon="@Icons.Material.Filled.Save"
                                  Color="Color.Primary"
                                  Variant="MudBlazor.Variant.Filled"
                                  OnClick="async () => await ViewModel.SaveCommand.ExecuteAsync(false)">@MediaGroupEditDialogRes.ButtonSave</MudLoadingButton>
            </MudTooltip>
        }
        else
        {
            <MudTooltip Placement="Placement.Top" Arrow="true" Text="@MediaGroupEditDialogRes.TooltipSaveContinue" ShowOnFocus="false">
                <MudLoadingButton Loading="@ViewModel.IsSaving"
                                  LoadingAdornment="Adornment.Start"
                                  StartIcon="@Icons.Material.Filled.Save"
                                  Color="Color.Primary"
                                  Variant="MudBlazor.Variant.Filled"
                                  OnClick="async () => await ViewModel.SaveCommand.ExecuteAsync(true)">@MediaGroupEditDialogRes.ButtonSaveContinue</MudLoadingButton>
            </MudTooltip>
        }
        @if (!IsInEditMode)
        {
            <MudMenu Style="margin-left: 1px!important">
                <ActivatorContent>
                    <MudTooltip Text="@MediaGroupEditDialogRes.TooltipShowSaveOptions" ShowOnFocus="false">
                        <MudIconButton Icon="@Icons.Material.Filled.ArrowDropDown"
                                       Variant="MudBlazor.Variant.Filled"
                                       Color="Color.Primary"
                                       Disabled="@ViewModel.IsSaving">
                        </MudIconButton>
                    </MudTooltip>
                </ActivatorContent>
                <ChildContent>
                    <MudMenuItem OnClick="async () => await ViewModel.SaveCommand.ExecuteAsync(false)">@MediaGroupEditDialogRes.ButtonSave</MudMenuItem>
                    <MudMenuItem OnClick="async () => await ViewModel.SaveCommand.ExecuteAsync(true)">@MediaGroupEditDialogRes.TooltipSaveContinue</MudMenuItem>
                </ChildContent>
            </MudMenu>
        }
        <MudTooltip Placement="Placement.Top" Arrow="true" Text="@MediaGroupEditDialogRes.TooltipCancel" ShowOnFocus="false">
            <MudButton Disabled="@ViewModel.IsSaving" OnClick="async () => await ViewModel.CancelCommand.ExecuteAsync(null)">@MediaGroupEditDialogRes.ButtonCancel</MudButton>
        </MudTooltip>
    </DialogActions>
</MudDialog>

@code
{
    [CascadingParameter]
    public MudDialogInstance MudDialog 
    { 
        get
        {
            return ViewModel.MudDialog;
        }
        set
        {
            ViewModel.MudDialog = value;
        }
    } 

    [Parameter]
    public bool IsInEditMode 
    { 
        get
        {
            return ViewModel.IsInEditMode;
        }
        set
        {
            ViewModel.IsInEditMode = value;
        }
    }

    [Parameter]
    public IMediaGroupModel? Model 
    { 
        get
        {
            return ViewModel.Model;
        }
        set
        {
            ViewModel.Model = value;
        }
    }
}